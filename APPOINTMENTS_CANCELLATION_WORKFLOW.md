# ุดุฑุญ ูุธุงู ุฅูุบุงุก ุงูููุงุนูุฏ (Appointment Cancellation)

## ููุงุฐุง ูุทูุจ ุณุจุจ ุงูุฅูุบุงุกุ

ุนูุฏ ุฅูุบุงุก ููุนุฏ ูุนุงููุฉ ูู ููุญุฉ ุงูุฃุฏููุ ุงููุธุงู ุจูุทูุจ ุณุจุจ ุงูุฅูุบุงุก ูู 3 ุฃุณุจุงุจ ุฑุฆูุณูุฉ:

### 1. **ุงูุดูุงููุฉ ูุน ุงูุนููู** ๐ค
- ุงูุณุจุจ ุจูุชุจุนุช ููุนููู ูู ุฅูููู ุงูุฅูุบุงุก
- ุงูุนููู ูุนุฑู ููู ุชู ุฅูุบุงุก ุงูููุนุฏ ุจุชุงุนู
- ูุฒูุฏ ูู ูุตุฏุงููุฉ ุงูุดุฑูุฉ

### 2. **ุงูุชูุซูู ูุงูุฃุฑุดูุฉ** ๐
- ุงูุณุจุจ ุจูุชุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูููู ุงูุฑุฌูุน ููู ูู ุฃู ููุช
- ูููุฏ ูู ุญุงูุฉ ุฃู ูุฒุงุนุงุช ุฃู ุงุณุชูุณุงุฑุงุช ูุงุญูุฉ

### 3. **ุงูุชุญููู ูุงูุชุญุณูู** ๐
- ูุนุฑูุฉ ุงูุฃุณุจุงุจ ุงูุดุงุฆุนุฉ ููุฅูุบุงุก
- ุชุญุณูู ุงูุนูููุงุช ุจูุงุกู ุนูู ุงูุจูุงูุงุช
- ุชูููู ูุณุจุฉ ุงูุฅูุบุงุกุงุช ูู ุงููุณุชูุจู

---

## ุฃูู ูุฐูุจ ุณุจุจ ุงูุฅูุบุงุกุ

ุนูุฏ ูุชุงุจุฉ ุณุจุจ ุงูุฅูุบุงุก ูุงูุถุบุท ุนูู "ุฅูุบุงุก ุงูููุนุฏ"ุ ุงูุณุจุจ ุจูุฑูุญ ูู 4 ุฃูุงูู:

### 1. **ูุงุนุฏุฉ ุงูุจูุงูุงุช (Database)** ๐พ
```typescript
// ูู ุฌุฏูู appointments
{
  status: 'CANCELLED',
  cancelledAt: '2026-01-03T18:20:00.000Z',
  cancellationReason: 'ุงูุนููู ุทูุจ ุชุฃุฌูู ุงูููุนุฏ ูุธุฑูู ุทุงุฑุฆุฉ'
}
```

**ุงููุงุฆุฏุฉ:**
- ุญูุธ ุฏุงุฆู ููุณุฌูุงุช
- ุฅููุงููุฉ ุงูุจุญุซ ูุงูููุชุฑุฉ
- ุงูุชุชุจุน ุงูุชุงุฑูุฎู

### 2. **ุฅูููู ููุนููู** ๐ง
ูุชู ุฅุฑุณุงู ุฅูููู ุชููุงุฆู ููุนููู ูุญุชูู ุนูู:

```html
โ ุชู ุฅูุบุงุก ููุนุฏ ุงููุนุงููุฉ

ุนุฒูุฒู [ุงุณู ุงูุนููู]ุ

ูุฃุณู ูุฅุจูุงุบู ุจุฃูู ุชู ุฅูุบุงุก ููุนุฏ ุงููุนุงููุฉ.

๐ ุชูุงุตูู ุงูููุนุฏ ุงูููุบู:
- ุงูุนูุงุฑ: [ุงุณู ุงูุนูุงุฑ]
- ุงูุชุงุฑูุฎ: [ุงูุชุงุฑูุฎ]
- ุงูููุช: [ุงูููุช]
- ุณุจุจ ุงูุฅูุบุงุก: [ุงูุณุจุจ ุงูุฐู ูุชุจุชู]

ููููู ุญุฌุฒ ููุนุฏ ุขุฎุฑ ูู ุฃู ููุช.
```

**ุงููุงุฆุฏุฉ:**
- ุงูุนููู ูุนุฑู ุงูุณุจุจ ููุฑุงู
- ุงุญุชุฑุงููุฉ ูู ุงูุชุนุงูู
- ุงูุดูุงููุฉ ุชุจูู ุงูุซูุฉ

### 3. **ุชูุงุตูู ุงูููุนุฏ ูู ุงูุฃุฏูู** ๐๏ธ
ุนูุฏ ูุชุญ ุชูุงุตูู ุงูููุนุฏ ุงูููุบูุ ุจูุธูุฑ ูุณู ุฎุงุต:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุณุจุจ ุงูุฅูุบุงุก                    โ
โ                                 โ
โ [ุงูุณุจุจ ุงูุฐู ูุชุจุชู ูุธูุฑ ููุง]    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ุงููุงุฆุฏุฉ:**
- ุงูุฃุฏููุฒ ุงูุขุฎุฑูู ูุดูููุง ุงูุณุจุจ
- ุณูููุฉ ุงููุชุงุจุนุฉ
- ุงูุชูุซูู ุงูุฏุงุฎูู

### 4. **ุณุฌู ุงูุชุญุฏูุซุงุช (Audit Log)** ๐
ุงููุธุงู ุจูุณุฌู:
- ูู ูุงู ุจุงูุฅูุบุงุก
- ูุชู ุชู ุงูุฅูุบุงุก
- ุงูุณุจุจ ุงููุฐููุฑ
- ุญุงูุฉ ุงูููุนุฏ ูุจู ูุจุนุฏ

**ุงููุงุฆุฏุฉ:**
- ุงููุณุงุกูุฉ ูุงููุชุงุจุนุฉ
- ุงูุชุชุจุน ุงููุงูู
- ุงูุฃูุงู

---

## ูุซุงู ุนููู

### ุงูุณููุงุฑูู:
ุนููู ุญุฌุฒ ููุนุฏ ููุนุงููุฉ ุดูุฉ ููู ุงูุณุจุช ุงูุณุงุนุฉ 3 ุนุตุฑุงูุ ููู ุงูุดูุฉ ุงุชุจุงุนุช.

### ุงูุฎุทูุงุช:

1. **ุงูุฃุฏูู ููุชุญ ุตูุญุฉ ุงูููุงุนูุฏ**
   - `/admin/appointments`

2. **ูุถุบุท ุนูู ุฒุฑ "ุฅูุบุงุก" ููููุนุฏ**
   - Modal ููุชุญ ูุทูุจ ุงูุณุจุจ

3. **ููุชุจ ุงูุณุจุจ:**
   ```
   ุชู ุจูุน ุงูุนูุงุฑ ุจุงููุนูุ ูุนุชุฐุฑ ููุนููู ููุฑุฌู ููู ุงุฎุชูุงุฑ ุนูุงุฑ ุขุฎุฑ
   ```

4. **ูุถุบุท "ุฅูุบุงุก ุงูููุนุฏ"**

### ูุง ูุญุฏุซ ุจุนุฏ ุฐูู:

โ **ูู ุงูุซุงููุฉ ููุณูุง:**
- ุงูููุนุฏ ูุชุญูู ูู CANCELLED
- ุงูุณุจุจ ูุชุญูุธ ูู Database
- ุฅูููู ูุชุจุนุช ููุนููู ุชููุงุฆูุงู

โ **ุงูุนููู ูุณุชูู ุฅูููู:**
```
ุนุฒูุฒู ุฃุญูุฏ ูุญูุฏุ

ูุฃุณู ูุฅุจูุงุบู ุจุฃูู ุชู ุฅูุบุงุก ููุนุฏ ุงููุนุงููุฉ.

ุณุจุจ ุงูุฅูุบุงุก: ุชู ุจูุน ุงูุนูุงุฑ ุจุงููุนูุ ูุนุชุฐุฑ ููุนููู 
ููุฑุฌู ููู ุงุฎุชูุงุฑ ุนูุงุฑ ุขุฎุฑ

๐ ููุชูุงุตู: 01000025080
```

โ **ูู ุชูุงุตูู ุงูููุนุฏ:**
- ุงูุณุจุจ ูุธูุฑ ูู ูุณู "ุณุจุจ ุงูุฅูุบุงุก"
- ูุน ููู ุฃุญูุฑ ุฎููู ููุชูููุฒ

---

## ููุงุฐุง ุงูุณุจุจ **ุฅุฌุจุงุฑู**ุ

ุงูุฒุฑ "ุฅูุบุงุก ุงูููุนุฏ" **ูุนุทู** ูุญุฏ ูุง ุชูุชุจ ุณุจุจุ ูุฃู:

1. **ุญู ุงูุนููู** - ูุณุชุญู ูุนุฑู ููู ุชู ุงูุฅูุบุงุก
2. **ุงูุงุญุชุฑุงููุฉ** - ุงูุดุฑูุงุช ุงููุจูุฑุฉ ุฏุงููุงู ุชุฏู ุฃุณุจุงุจ
3. **ุงูุญูุงูุฉ ุงููุงููููุฉ** - ูู ุญุงูุฉ ุฃู ูุดุงููุ ุงูุณุจุจ ููุซู
4. **ุงูุชุญุณูู ุงููุณุชูุฑ** - ุจุฏูู ุฃุณุจุงุจุ ูุด ููุนุฑู ูุญุณู ุงูุฎุฏูุฉ

---

## ุฃูุซูุฉ ูุฃุณุจุงุจ ุฅูุบุงุก ุฌูุฏุฉ:

### โ **ุฃุณุจุงุจ ูุงุถุญุฉ ููููุฏุฉ:**
- "ุชู ุจูุน ุงูุนูุงุฑ ููุฃุณู"
- "ุงูุนููู ุทูุจ ุชุฃุฌูู ุงูููุนุฏ ูุธุฑูู ุนูู ุทุงุฑุฆุฉ"
- "ุงูููุนุฏ ูุชุนุงุฑุถ ูุน ููุนุฏ ุขุฎุฑุ ุณูุชู ุญุฌุฒ ููุนุฏ ุจุฏูู"
- "ุงูุนูุงุฑ ุชุญุช ุงูุตูุงูุฉ ุญุงููุงู"
- "ุงูุนููู ุฃูุบู ุนุจุฑ ุงููุงุชู"

### โ **ุฃุณุจุงุจ ุบูุฑ ูููุฏุฉ:**
- "ุฅูุบุงุก" (ุบูุฑ ูุงุถุญ)
- "ูุง" (ุบูุฑ ุงุญุชุฑุงูู)
- "..." (ุนุฏูู ุงููุงุฆุฏุฉ)
- "ุงูุบูุช" (ูุฎุชุตุฑ ุฌุฏุงู)

---

## ุฅุญุตุงุฆูุงุช ูุชุญููู

ููููู ุงุณุชุฎุฑุงุฌ ุชูุงุฑูุฑ ุนู:

### ุฃูุซุฑ ุฃุณุจุงุจ ุงูุฅูุบุงุก ุชูุฑุงุฑุงู:
```sql
SELECT cancellationReason, COUNT(*) as count
FROM appointments
WHERE status = 'CANCELLED'
GROUP BY cancellationReason
ORDER BY count DESC
```

### ูุณุจุฉ ุงูุฅูุบุงุกุงุช:
```
Total: 100 appointment
Cancelled: 15 appointments
Cancellation Rate: 15%
```

### ุชุญููู ุงูุฃุณุจุงุจ:
- 40% - ุงูุนููู ุฃูุบู
- 30% - ุงูุนูุงุฑ ุบูุฑ ูุชุงุญ
- 20% - ุชุนุงุฑุถ ููุงุนูุฏ
- 10% - ุฃุณุจุงุจ ุฃุฎุฑู

---

## ููุงุญุธุงุช ูููุฉ

### ๐ **ุงูุฃูุงู:**
- ููุท ุงูุฃุฏููุฒ ููุฏุฑูุง ููุบูุง ุงูููุงุนูุฏ
- ุงูุณุจุจ ูุญููุธ ููุฑุจูุท ุจูู ูุงู ุจุงูุฅูุบุงุก

### ๐ฑ **ุงูุฅุดุนุงุฑุงุช:**
- ุฅูููู ููุฑู ููุนููู
- ูุญุชูู ุนูู ุณุจุจ ุงูุฅูุบุงุก
- ูุนูููุงุช ุงูุชูุงุตู ููุงุณุชูุณุงุฑ

### ๐จ **ุงููุงุฌูุฉ:**
- Modal ุงุญุชุฑุงูู ูุน ุชุตููู ูุงุถุญ
- ุญูู ุงูุณุจุจ ุฅุฌุจุงุฑู (*)
- ุงูุฒุฑ ูุนุทู ูู ุงูุณุจุจ ูุงุถู

---

## ุงููููุงุช ุงููุชุนููุฉ

### Frontend:
- `src/app/admin/appointments/page.tsx`
  - Lines 86: ุชุนุฑูู state ููุณุจุจ
  - Lines 196-227: handleCancelAppointment function
  - Lines 875-920: Cancel Modal

### Backend:
- `src/app/api/appointments/[id]/route.ts`
  - Lines 108-111: ุญูุธ ุงูุณุจุจ ูู Database
  - Lines 180-220: ุฅุฑุณุงู ุฅูููู ุงูุฅูุบุงุก ูุน ุงูุณุจุจ

### Database:
- `prisma/schema.prisma`
  - Model: Appointment
  - Field: cancellationReason (String?, optional)

---

## ุงูุชุทููุฑุงุช ุงููุณุชูุจููุฉ ุงูููุชุฑุญุฉ

### 1. **ูุงุฆูุฉ ุฃุณุจุงุจ ุฌุงูุฒุฉ**
```typescript
const cancellationReasons = [
  'ุชู ุจูุน ุงูุนูุงุฑ',
  'ุงูุนููู ุทูุจ ุงูุชุฃุฌูู',
  'ุชุนุงุฑุถ ููุงุนูุฏ',
  'ุงูุนูุงุฑ ุชุญุช ุงูุตูุงูุฉ',
  'ุฃุฎุฑู (ุญุฏุฏ ุงูุณุจุจ)'
]
```

### 2. **ุฅุญุตุงุฆูุงุช ูู Dashboard**
ุนุฑุถ:
- ุนุฏุฏ ุงูููุงุนูุฏ ุงูููุบุงุฉ ุงูููู/ุงูุฃุณุจูุน/ุงูุดูุฑ
- ุฃูุซุฑ ุงูุฃุณุจุงุจ ุดููุนุงู
- ูุนุฏู ุงูุฅูุบุงุก

### 3. **ุชูุจููุงุช ุชููุงุฆูุฉ**
- ุฅุฐุง ูุงู ุณุจุจ ุงูุฅูุบุงุก "ุชู ุจูุน ุงูุนูุงุฑ" โ ุชุญุฏูุซ ุญุงูุฉ ุงูุนูุงุฑ ุชููุงุฆูุงู
- ุฅุฐุง ุงูุนููู ุฃูุบู ุฃูุซุฑ ูู 3 ูุฑุงุช โ ุชูุจูู ูููุชุงุจุนุฉ

### 4. **ุชุตููู ุงูุฃุณุจุงุจ**
```typescript
categories: {
  client_cancelled: 'ุงูุนููู ุฃูุบู',
  property_unavailable: 'ุงูุนูุงุฑ ุบูุฑ ูุชุงุญ',
  scheduling_conflict: 'ุชุนุงุฑุถ ููุงุนูุฏ',
  other: 'ุฃุฎุฑู'
}
```

---

**ุชู ุงูุชูุซูู ูู:** 3 ููุงูุฑ 2026  
**ุงูุฅุตุฏุงุฑ:** 1.0  
**ุงูุญุงูุฉ:** ูุดุท โ
