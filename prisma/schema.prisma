generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id                                  String              @id @default(cuid())
  email                               String              @unique
  firstName                           String
  lastName                            String
  phone                               String?
  avatar                              String?
  password                            String
  userType                            UserType            @default(INDIVIDUAL)
  verified                            Boolean             @default(false)
  emailVerified                       Boolean             @default(false)
  phoneVerified                       Boolean             @default(false)
  emailVerifyToken                    String?
  phoneVerifyToken                    String?
  verifyTokenExpiry                   DateTime?
  active                              Boolean             @default(true)
  createdAt                           DateTime            @default(now())
  updatedAt                           DateTime            @updatedAt
  appointments                        Appointment[]
  favorites                           Favorite[]
  inquiries                           Inquiry[]
  listing_favorites                   listing_favorites[]
  listings                            listings[]
  messages_messages_receiverIdTousers messages[]          @relation("messages_receiverIdTousers")
  messages_messages_senderIdTousers   messages[]          @relation("messages_senderIdTousers")
  properties                          Property[]
  reports                             reports[]
  reviews_reviews_authorIdTousers     reviews[]           @relation("reviews_authorIdTousers")
  reviews_reviews_targetIdTousers     reviews[]           @relation("reviews_targetIdTousers")
  activities                          UserActivity[]
  notifications                       Notification[]

  @@map("users")
}

model Admin {
  id           String          @id @default(cuid())
  username     String          @unique
  email        String          @unique
  firstName    String
  lastName     String
  password     String
  role         AdminRole       @default(MODERATOR)
  permissions  Json?
  active       Boolean         @default(true)
  lastLogin    DateTime?
  lastLoginIp  String?
  createdAt    DateTime        @default(now())
  updatedAt    DateTime        @updatedAt
  refreshToken String?         @db.Text
  tokenVersion Int             @default(0)
  activities   AdminActivity[]
  sessions     AdminSession[]

  @@map("admins")
}

model AdminActivity {
  id         String   @id @default(cuid())
  adminId    String
  action     String
  targetType String?
  targetId   String?
  details    Json?
  ipAddress  String?
  userAgent  String?
  createdAt  DateTime @default(now())
  admin      Admin    @relation(fields: [adminId], references: [id], onDelete: Cascade)

  @@index([adminId])
  @@index([action])
  @@index([createdAt])
  @@map("admin_activities")
}

model AdminSession {
  id           String   @id @default(cuid())
  adminId      String
  token        String   @unique
  ipAddress    String?
  userAgent    String?
  device       String?
  browser      String?
  os           String?
  location     String?
  isActive     Boolean  @default(true)
  lastActivity DateTime @default(now())
  expiresAt    DateTime
  createdAt    DateTime @default(now())
  admin        Admin    @relation(fields: [adminId], references: [id], onDelete: Cascade)

  @@index([adminId])
  @@index([token])
  @@index([isActive])
  @@map("admin_sessions")
}

model Property {
  id                String          @id @default(cuid())
  title             String
  description       String          @db.Text
  price             Decimal         @db.Decimal(12, 2)
  currency          Currency        @default(EGP)
  negotiable        Boolean         @default(false)
  area              Int
  bedrooms          Int?
  bathrooms         Int?
  floors            Int?
  floor             Int?
  parking           Boolean         @default(false)
  furnished         Boolean         @default(false)
  city              String
  district          String
  address           String          @db.Text
  latitude          Float?
  longitude         Float?
  propertyType      PropertyType
  purpose           PropertyPurpose
  status            PropertyStatus  @default(PENDING)
  features          String?         @db.Text
  additionalDetails String?         @db.Text
  views             Int             @default(0)
  contactName       String
  contactPhone      String
  contactEmail      String
  userId            String
  reviewStatus      ReviewStatus    @default(PENDING)
  reviewedBy        String?
  reviewedAt        DateTime?
  rejectionReason   String?         @db.Text
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  appointments      Appointment[]
  favorites         Favorite[]
  inquiries         Inquiry[]
  notifications     Notification[]
  user              User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  images            PropertyImage[]

  @@index([city, district])
  @@index([propertyType, purpose])
  @@index([price, currency])
  @@index([userId], map: "properties_userId_fkey")
  @@map("properties")
}

model PropertyImage {
  id         String   @id @default(cuid())
  url        String
  publicId   String?
  alt        String?
  isMain     Boolean  @default(false)
  order      Int      @default(0)
  propertyId String
  createdAt  DateTime @default(now())
  property   Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)

  @@index([propertyId], map: "property_images_propertyId_fkey")
  @@map("property_images")
}

model Project {
  id              String            @id @default(cuid())
  title           String
  description     String            @db.Text
  location        String
  developer       String
  projectType     ProjectType
  status          ProjectStatus     @default(PLANNING)
  price           Decimal?          @db.Decimal(12, 2)
  bedrooms        Int?
  area            Int?
  type            String?
  totalUnits      Int?
  availableUnits  Int?
  minPrice        Decimal?          @db.Decimal(12, 2)
  maxPrice        Decimal?          @db.Decimal(12, 2)
  currency        Currency          @default(EGP)
  deliveryDate    DateTime?
  features        String?           @db.Text
  specifications  String?           @db.Text
  paymentPlan     String?           @db.Text
  locationDetails String?           @db.Text
  mainImage       String?
  contactName     String
  contactPhone    String
  contactEmail    String
  featured        Boolean           @default(false)
  published       Boolean           @default(true)
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  images          ProjectImage[]
  portfolioItems  PortfolioItem[]   @relation("ProjectPortfolio")

  @@map("projects")
}

model ProjectImage {
  id        String   @id @default(cuid())
  url       String
  publicId  String?
  alt       String?
  isMain    Boolean  @default(false)
  order     Int      @default(0)
  projectId String
  createdAt DateTime @default(now())
  project   Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId], map: "project_images_projectId_fkey")
  @@map("project_images")
}

model PortfolioItem {
  id                   String            @id @default(cuid())
  slug                 String            @unique
  title                String
  description          String            @db.Text
  fullDescription      String?           @db.Text
  category             PortfolioCategory
  status               PortfolioStatus   @default(COMPLETED)
  location             String
  client               String
  duration             String
  area                 String
  budget               String
  completionDate       String
  mainImage            String
  mainImagePublicId    String?
  likes                Int               @default(0)
  views                Int               @default(0)
  rating               Float             @default(0)
  features             Json?
  tags                 Json?
  challenges           Json?
  solutions            Json?
  technologies         Json?
  teamMembers          Json?
  clientTestimonial    Json?
  featured             Boolean           @default(false)
  published            Boolean           @default(true)
  serviceId            String?
  showInServiceGallery Boolean           @default(false)
  projectId            String?
  showInProject        Boolean           @default(false)
  createdAt            DateTime          @default(now())
  updatedAt            DateTime          @updatedAt
  images               PortfolioImage[]
  service              Service?          @relation("ServicePortfolio", fields: [serviceId], references: [id])
  project              Project?          @relation("ProjectPortfolio", fields: [projectId], references: [id])

  @@index([serviceId])
  @@index([projectId])
  @@map("portfolio_items")
}

model PortfolioImage {
  id          String        @id @default(cuid())
  url         String
  publicId    String?
  alt         String?
  order       Int           @default(0)
  portfolioId String
  createdAt   DateTime      @default(now())
  portfolio   PortfolioItem @relation(fields: [portfolioId], references: [id], onDelete: Cascade)

  @@index([portfolioId], map: "portfolio_images_portfolioId_fkey")
  @@map("portfolio_images")
}

model Favorite {
  id         String   @id @default(cuid())
  userId     String
  propertyId String
  createdAt  DateTime @default(now())
  property   Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, propertyId])
  @@index([propertyId], map: "favorites_propertyId_fkey")
  @@map("favorites")
}

model Inquiry {
  id          String        @id @default(cuid())
  name        String
  email       String
  phone       String?
  subject     String
  message     String        @db.Text
  inquiryType InquiryType   @default(PROPERTY)
  status      InquiryStatus @default(PENDING)
  userId      String?
  propertyId  String?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  property    Property?     @relation(fields: [propertyId], references: [id])
  user        User?         @relation(fields: [userId], references: [id])

  @@index([propertyId], map: "inquiries_propertyId_fkey")
  @@index([userId], map: "inquiries_userId_fkey")
  @@map("inquiries")
}

model Appointment {
  id              String            @id @default(cuid())
  userId          String?
  propertyId      String?
  listingId       String?
  contactName     String
  contactEmail    String
  contactPhone    String
  appointmentDate DateTime
  timeSlot        String
  status          AppointmentStatus @default(PENDING)
  notes           String?           @db.Text
  adminNotes      String?           @db.Text
  confirmedAt     DateTime?
  confirmedBy     String?
  cancelledAt     DateTime?
  cancellationReason String?        @db.Text
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  user            User?             @relation(fields: [userId], references: [id], onDelete: Cascade)
  property        Property?         @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  listing         listings?         @relation(fields: [listingId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([propertyId])
  @@index([listingId])
  @@index([appointmentDate])
  @@index([status])
  @@map("appointments")
}

model listing_categories {
  id          String     @id
  name        String     @unique
  nameAr      String     @unique
  description String?    @db.Text
  icon        String?
  color       String?
  order       Int        @default(0)
  active      Boolean    @default(true)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime
  listings    listings[]
}

model listing_favorites {
  id        String   @id
  userId    String
  listingId String
  createdAt DateTime @default(now())
  listings  listings @relation(fields: [listingId], references: [id], onDelete: Cascade)
  users     User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, listingId])
  @@index([listingId], map: "listing_favorites_listingId_fkey")
}

model listing_images {
  id        String   @id
  url       String
  publicId  String?
  alt       String?
  isMain    Boolean  @default(false)
  order     Int      @default(0)
  listingId String
  createdAt DateTime @default(now())
  listings  listings @relation(fields: [listingId], references: [id], onDelete: Cascade)

  @@index([listingId], map: "listing_images_listingId_fkey")
}

model listing_stats {
  id             String   @id
  listingId      String   @unique
  totalViews     Int      @default(0)
  uniqueViews    Int      @default(0)
  todayViews     Int      @default(0)
  weekViews      Int      @default(0)
  monthViews     Int      @default(0)
  totalInquiries Int      @default(0)
  totalFavorites Int      @default(0)
  phoneClicks    Int      @default(0)
  whatsappClicks Int      @default(0)
  emailClicks    Int      @default(0)
  sourceData     Json?
  updatedAt      DateTime
}

model listing_videos {
  id        String   @id
  url       String
  publicId  String?
  title     String?
  duration  Int?
  thumbnail String?
  listingId String
  createdAt DateTime @default(now())
  listings  listings @relation(fields: [listingId], references: [id], onDelete: Cascade)

  @@index([listingId], map: "listing_videos_listingId_fkey")
}

model listings {
  id                 String                @id
  title              String
  description        String                @db.Text
  price              Decimal               @db.Decimal(12, 2)
  currency           listings_currency     @default(EGP)
  priceType          listings_priceType    @default(FIXED)
  propertyType       listings_propertyType
  purpose            listings_purpose
  area               Int
  bedrooms           Int?
  bathrooms          Int?
  floors             Int?
  floor              Int?
  age                Int?
  furnished          Boolean               @default(false)
  parking            Boolean               @default(false)
  elevator           Boolean               @default(false)
  balcony            Boolean               @default(false)
  garden             Boolean               @default(false)
  swimmingPool       Boolean               @default(false)
  security           Boolean               @default(false)
  airConditioning    Boolean               @default(false)
  governorate        String
  city               String
  district           String
  address            String                @db.Text
  latitude           Float?
  longitude          Float?
  nearbyPlaces       Json?
  virtualTour        String?
  contactName        String
  contactPhone       String
  contactEmail       String?
  whatsappNumber     String?
  showContactInfo    Boolean               @default(false)
  status             listings_status       @default(PENDING)
  featured           Boolean               @default(false)
  urgent             Boolean               @default(false)
  views              Int                   @default(0)
  favoritesCount     Int                   @default(0)
  inquiries          Int                   @default(0)
  adminNotes         String?               @db.Text
  rejectionReason    String?               @db.Text
  approvedAt         DateTime?
  approvedBy         String?
  expiresAt          DateTime?
  publishedAt        DateTime?
  createdAt          DateTime              @default(now())
  updatedAt          DateTime
  userId             String
  categoryId         String
  appointments       Appointment[]
  listing_favorites  listing_favorites[]
  listing_images     listing_images[]
  listing_videos     listing_videos[]
  listing_categories listing_categories    @relation(fields: [categoryId], references: [id])
  users              User                  @relation(fields: [userId], references: [id], onDelete: Cascade)
  messages           messages[]
  reports            reports[]

  @@index([categoryId], map: "listings_categoryId_fkey")
  @@index([createdAt, status])
  @@index([governorate, city, district])
  @@index([price, currency])
  @@index([propertyType, purpose, status])
  @@index([userId, status])
}

model messages {
  id                               String               @id
  subject                          String?
  content                          String               @db.Text
  messageType                      messages_messageType @default(INQUIRY)
  status                           messages_status      @default(UNREAD)
  attachments                      Json?
  senderId                         String
  receiverId                       String
  listingId                        String?
  parentId                         String?
  readAt                           DateTime?
  createdAt                        DateTime             @default(now())
  updatedAt                        DateTime
  listings                         listings?            @relation(fields: [listingId], references: [id], onDelete: Cascade)
  messages                         messages?            @relation("messagesTomessages", fields: [parentId], references: [id], onDelete: Cascade)
  other_messages                   messages[]           @relation("messagesTomessages")
  users_messages_receiverIdTousers User                 @relation("messages_receiverIdTousers", fields: [receiverId], references: [id], onDelete: Cascade)
  users_messages_senderIdTousers   User                 @relation("messages_senderIdTousers", fields: [senderId], references: [id], onDelete: Cascade)

  @@index([listingId, createdAt])
  @@index([parentId], map: "messages_parentId_fkey")
  @@index([receiverId, status, createdAt])
  @@index([senderId, createdAt])
}

model reports {
  id          String         @id
  reason      reports_reason
  description String?        @db.Text
  status      reports_status @default(PENDING)
  evidence    Json?
  adminNotes  String?        @db.Text
  reporterId  String
  listingId   String?
  handledBy   String?
  handledAt   DateTime?
  createdAt   DateTime       @default(now())
  updatedAt   DateTime
  listings    listings?      @relation(fields: [listingId], references: [id], onDelete: Cascade)
  users       User           @relation(fields: [reporterId], references: [id], onDelete: Cascade)

  @@index([listingId, status])
  @@index([reporterId], map: "reports_reporterId_fkey")
  @@index([status, createdAt])
}

model reviews {
  id                            String             @id
  rating                        Int
  comment                       String?            @db.Text
  reviewType                    reviews_reviewType @default(USER)
  communication                 Float?
  reliability                   Float?
  professionalism               Float?
  authorId                      String
  targetId                      String
  createdAt                     DateTime           @default(now())
  updatedAt                     DateTime
  users_reviews_authorIdTousers User               @relation("reviews_authorIdTousers", fields: [authorId], references: [id], onDelete: Cascade)
  users_reviews_targetIdTousers User               @relation("reviews_targetIdTousers", fields: [targetId], references: [id], onDelete: Cascade)

  @@unique([authorId, targetId])
  @@index([targetId], map: "reviews_targetId_fkey")
}

model UserActivity {
  id           String       @id @default(cuid())
  userId       String
  activityType ActivityType
  entityType   EntityType
  entityId     String?
  title        String
  description  String?      @db.Text
  metadata     Json?
  ipAddress    String?
  userAgent    String?
  createdAt    DateTime     @default(now())
  user         User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, createdAt])
  @@index([activityType])
  @@map("user_activities")
}

model Service {
  id                String          @id @default(cuid())
  slug              String          @unique
  title             String
  description       String          @db.Text
  heroImage         String
  heroImagePublicId String?
  cardImage         String?
  cardImagePublicId String?
  features          Json
  stats             Json
  gallery           Json
  galleryPublicIds  Json?
  formOptions       Json
  color             String
  iconName          String
  published         Boolean         @default(true)
  featured          Boolean         @default(false)
  order             Int             @default(0)
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  portfolioItems    PortfolioItem[] @relation("ServicePortfolio")

  @@map("services")
}

model HeroStats {
  id                 String   @id @default(cuid())
  yearsOfExperience  Int      @default(15)
  completedProjects  Int      @default(200)
  happyClients       Int      @default(500)
  clientSatisfaction Int      @default(98)
  heroImage          String?  @db.Text
  heroImagePublicId  String?
  isActive           Boolean  @default(true)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@map("hero_stats")
}

model TestimonialStats {
  id                String   @id @default(cuid())
  happyClients      Int      @default(5000)
  satisfactionRate  Int      @default(99)
  averageRating     Float    @default(4.9)
  yearsOfExperience Int      @default(15)
  isActive          Boolean  @default(true)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@map("testimonial_stats")
}

model Testimonial {
  id            String   @id @default(cuid())
  content       String   @db.Text
  clientName    String
  position      String
  location      String?
  image         String?
  imagePublicId String?
  rating        Int      @default(5)
  featured      Boolean  @default(false)
  published     Boolean  @default(true)
  order         Int      @default(0)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("testimonials")
}

model FooterInfo {
  id                String   @id @default(cuid())
  title             String   @default("? AMG Real Estate - شريكك الموثوق في عالم العقارات")
  subtitle          String   @default("ابدأ رحلتك العقارية معنا اليوم")
  yearsExperience   Int      @default(15)
  happyClients      Int      @default(5000)
  completedProjects Int      @default(200)
  contactPhone      String   @default("+20 123 456 7890")
  contactEmail      String   @default("info@amgrealestate.com")
  address           String   @default("القاهرة، مصر")
  whatsapp          String?
  isActive          Boolean  @default(true)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@map("footer_info")
}

model PortfolioStats {
  id            String   @id @default(cuid())
  totalProjects Int      @default(50)
  happyClients  Int      @default(125)
  averageRating Float    @default(4.8)
  totalViews    Int      @default(12000)
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("portfolio_stats")
}

model AboutPage {
  id                String   @id @default(cuid())
  companyName       String   @default("مجموعة أحمد الملاح")
  companyFullName   String   @default("مجموعة أحمد الملاح للمقاولات والتشطيبات والتسويق العقاري")
  foundedYear       Int      @default(2009)
  founderImage      String?  @db.Text
  yearsOfExperience Int      @default(15)
  completedProjects Int      @default(500)
  happyClients      Int      @default(1000)
  teamSize          Int      @default(50)
  ourStory          String   @db.Text
  vision            String   @db.Text
  mission           String   @db.Text
  values            String   @db.Text
  principles        String   @db.Text
  tagline           String   @default("شريكك الموثوق في عالم العقارات")
  isActive          Boolean  @default(true)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@map("about_page")
}

model TeamMember {
  id        String   @id @default(cuid())
  name      String
  position  String
  image     String   @db.Text
  bio       String?  @db.Text
  order     Int      @default(0)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("team_members")
}

model SocialLinks {
  id        String   @id @default(cuid())
  facebook  String?  @db.Text
  instagram String?  @db.Text
  linkedin  String?  @db.Text
  tiktok    String?  @db.Text
  twitter   String?  @db.Text
  youtube   String?  @db.Text
  whatsapp  String?  @db.Text
  snapchat  String?  @db.Text
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("social_links")
}

model NewsletterSubscription {
  id                String             @id @default(cuid())
  email             String             @unique
  status            SubscriptionStatus @default(ACTIVE)
  source            String?
  ipAddress         String?
  userAgent         String?
  verificationToken String?
  verifiedAt        DateTime?
  unsubscribedAt    DateTime?
  unsubscribeReason String?            @db.Text
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt

  @@index([email])
  @@index([status, createdAt])
  @@map("newsletter_subscriptions")
}

enum UserType {
  INDIVIDUAL
  AGENT
  COMPANY
  ADMIN

  @@map("user_type")
}

enum AdminRole {
  SUPER_ADMIN
  ADMIN
  MODERATOR
  SUPPORT

  @@map("admin_role")
}

enum PropertyType {
  APARTMENT
  VILLA
  OFFICE
  COMMERCIAL
  LAND

  @@map("property_type")
}

enum PropertyPurpose {
  SALE
  RENT

  @@map("property_purpose")
}

enum PropertyStatus {
  ACTIVE
  SOLD
  RENTED
  PENDING
  INACTIVE

  @@map("property_status")
}

enum ReviewStatus {
  PENDING
  APPROVED
  REJECTED
  NEEDS_EDIT

  @@map("review_status")
}

enum ProjectType {
  RESIDENTIAL
  COMMERCIAL
  MIXED

  @@map("project_type")
}

enum ProjectStatus {
  PLANNING
  UNDER_CONSTRUCTION
  COMPLETED
  DELIVERED

  @@map("project_status")
}

enum Currency {
  EGP
  USD

  @@map("currency")
}

enum InquiryType {
  PROPERTY
  PROJECT
  SERVICE
  GENERAL

  @@map("inquiry_type")
}

enum InquiryStatus {
  PENDING
  IN_PROGRESS
  RESOLVED
  CLOSED

  @@map("inquiry_status")
}

enum PortfolioCategory {
  CONSTRUCTION
  FINISHING
  FURNITURE
  KITCHENS

  @@map("portfolio_category")
}

enum PortfolioStatus {
  COMPLETED
  IN_PROGRESS
  UPCOMING

  @@map("portfolio_status")
}

enum reports_reason {
  SPAM
  FAKE
  INAPPROPRIATE
  DUPLICATE
  FRAUD
  WRONG_CATEGORY
  CONTACT_ISSUE
  OTHER
}

enum messages_messageType {
  INQUIRY
  OFFER
  COMPLAINT
  SUPPORT
  GENERAL
}

enum reports_status {
  PENDING
  INVESTIGATING
  RESOLVED
  DISMISSED
}

enum reviews_reviewType {
  USER
  AGENT
  TRANSACTION
}

enum listings_currency {
  EGP
  USD
}

enum messages_status {
  UNREAD
  READ
  REPLIED
  ARCHIVED
}

enum listings_priceType {
  FIXED
  NEGOTIABLE
  AUCTION
}

enum listings_propertyType {
  APARTMENT
  VILLA
  OFFICE
  COMMERCIAL
  LAND
}

enum listings_purpose {
  SALE
  RENT
}

enum listings_status {
  DRAFT
  PENDING
  APPROVED
  REJECTED
  EXPIRED
  SOLD
  RENTED
  SUSPENDED
}

enum ActivityType {
  LOGIN
  LOGOUT
  REGISTER
  PROPERTY_CREATE
  PROPERTY_UPDATE
  PROPERTY_DELETE
  PROPERTY_VIEW
  PROPERTY_FAVORITE
  PROPERTY_UNFAVORITE
  INQUIRY_CREATE
  PROFILE_UPDATE
  PASSWORD_CHANGE
  EMAIL_VERIFY
  PHONE_VERIFY

  @@map("activity_type")
}

enum EntityType {
  USER
  PROPERTY
  PROJECT
  PORTFOLIO
  INQUIRY
  MESSAGE

  @@map("entity_type")
}

enum SubscriptionStatus {
  ACTIVE
  UNSUBSCRIBED
  BOUNCED
  PENDING

  @@map("subscription_status")
}

model Notification {
  id         String           @id @default(cuid())
  userId     String
  user       User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  type       NotificationType
  title      String
  message    String           @db.Text
  link       String?
  isRead     Boolean          @default(false)
  createdAt  DateTime         @default(now())
  propertyId String?
  property   Property?        @relation(fields: [propertyId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([isRead])
  @@index([createdAt])
  @@map("notifications")
}

enum NotificationType {
  PROPERTY_APPROVED
  PROPERTY_REJECTED
  PROPERTY_PENDING_REVIEW
  NEW_INQUIRY
  PROPERTY_SOLD
  SUBSCRIPTION_EXPIRING
  NEW_MESSAGE
  PROPERTY_UPDATED
  ADMIN_MESSAGE

  @@map("notification_type")
}

// ==========================================
// طلبات عرض العقارات للتسويق
// ==========================================

model PropertyListingRequest {
  id              String                      @id @default(cuid())
  
  // بيانات العقار
  propertyType    PropertyListingType
  purpose         ListingPurpose
  area            Float
  price           Float
  currency        String                      @default("EGP")
  
  // الموقع
  governorate     String
  city            String
  district        String
  address         String?
  
  // التفاصيل
  bedrooms        Int?
  bathrooms       Int?
  floors          Int?
  floor           Int?
  yearBuilt       Int?
  features        Json?                       // JSON array of features
  description     String                      @db.Text
  
  // الصور
  images          Json                        // JSON array of image URLs
  
  // بيانات المالك
  ownerName       String
  ownerPhone      String
  ownerEmail      String
  preferredTime   String?                     // صباحاً، ظهراً، مساءً
  
  // الخدمة المطلوبة
  serviceType     ListingServiceType
  
  // المستخدم المقدم للطلب
  submittedBy     String?                     // User ID who submitted
  
  // الحالة والمتابعة
  status          ListingRequestStatus        @default(PENDING)
  adminNotes      String?                     @db.Text
  assignedTo      String?                     // Admin ID
  
  // المعاينة
  visitDate       DateTime?
  visitNotes      String?                     @db.Text
  
  // التواريخ
  createdAt       DateTime                    @default(now())
  updatedAt       DateTime                    @updatedAt

  @@index([status])
  @@index([propertyType])
  @@index([createdAt])
  @@index([ownerEmail])
  @@index([submittedBy])
  @@map("property_listing_requests")
}

enum PropertyListingType {
  APARTMENT       // شقة
  VILLA           // فيلا
  TOWNHOUSE       // تاون هاوس
  DUPLEX          // دوبلكس
  PENTHOUSE       // بنتهاوس
  LAND            // أرض
  OFFICE          // مكتب
  COMMERCIAL      // محل تجاري
  WAREHOUSE       // مخزن
  BUILDING        // مبنى كامل
  
  @@map("property_listing_type")
}

enum ListingPurpose {
  SALE            // بيع
  RENT            // إيجار
  
  @@map("listing_purpose")
}

enum ListingServiceType {
  MARKETING_ONLY       // تسويق فقط
  MARKETING_AND_VISIT  // تسويق ومعاينة
  VALUATION            // تقييم العقار
  
  @@map("listing_service_type")
}

enum ListingRequestStatus {
  PENDING         // قيد الانتظار
  REVIEWING       // قيد المراجعة
  VISIT_SCHEDULED // تم جدولة معاينة
  APPROVED        // تمت الموافقة
  REJECTED        // مرفوض
  COMPLETED       // مكتمل
  
  @@map("listing_request_status")
}

model ServiceRequest {
  id            String              @id @default(cuid())
  name          String
  email         String
  phone         String
  serviceType   String
  projectType   String?
  budget        String?
  timeline      String?
  message       String?             @db.Text
  status        ServiceRequestStatus @default(PENDING)
  adminNotes    String?             @db.Text
  respondedAt   DateTime?
  respondedBy   String?
  createdAt     DateTime            @default(now())
  updatedAt     DateTime            @updatedAt

  @@index([status])
  @@index([createdAt])
  @@index([email])
  @@map("service_requests")
}

enum ServiceRequestStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  CANCELLED

  @@map("service_request_status")
}

enum AppointmentStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
  NO_SHOW

  @@map("appointment_status")
}
